### Tabular Data code 

---

# ğŸ“œ[Pstage_Competition]-Tabular Data

> Public Score : 0.8605 16ë“±

### ğŸ‘€[ëŒ€íšŒê°œìš”]

---

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/db560c06-7eeb-4687-abbe-4ab28704dc70/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/db560c06-7eeb-4687-abbe-4ab28704dc70/Untitled.png)

### ğŸ’¡[Date ì •ë³´]

---

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f349f77e-f5a3-40d4-adad-2852f6231900/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f349f77e-f5a3-40d4-adad-2852f6231900/Untitled.png)

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/436b0717-f285-4430-84fb-817707e860b6/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/436b0717-f285-4430-84fb-817707e860b6/Untitled.png)

- ì£¼ì–´ì§„ Dataì˜ featureë“¤ì„ ì´ìš©í•´ì„œ ë‹¤ìŒ ë‹¬ ì†Œë¹„ìë“¤ì´ 300$ì´ìƒì„ ì†Œë¹„ ìœ ë¬´ë¥¼ ì˜ˆì¸¡í•˜ëŠ” Competionì´ì—ˆìŠµë‹ˆë‹¤
- Data ì»¬ëŸ¼ ì„¤ëª…
    1. order_id=ì£¼ë¬¸ë²ˆí˜¸, ë°ì´í„°ì—ì„œ ê°™ì€ ì£¼ë¬¸ë²ˆí˜¸ëŠ” ë™ì¼ ì£¼ë¬¸ì„ ë‚˜íƒ€ëƒ„
    2. product_id: ìƒí’ˆ ë²ˆí˜¸ 
    3. description: ìƒí’ˆ ì„¤ëª… 
    4. quantitiy: ìƒí’ˆ ì£¼ë¬¸ ìˆ˜ëŸ‰ 
    5. order_data: ì£¼ë¬¸ ì¼ì 
    6. Price: ìƒí’ˆ ê°€ê²© 
    7. customer_id: ê³ ê° ë²ˆí˜¸ 
    8. country: ê³ ê° ê±°ì£¼ êµ­ê°€ 
    9. total : ì´êµ¬ë§¤ì•¡ 

# ğŸ’¡[EDA]

---

> Tabular Dataì— ìˆì–´ì„œ ê°€ì¥ ì¤‘ìš”í•œ ê±´ Dataì— ëŒ€í•œ ì´í•´ì™€ ë¶„ì„!

```markdown
ğŸ’¡ì •í˜•ë°ì´í„°ì— ìˆì–´ì„œ ì „ì²˜ë¦¬ì™€ ë°ì´í„° ë¶„ì„, ë¶„í¬ , ìƒê´€ ê´€ê³„, PCA ë“± ì •ë§ ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ
 
dataì—ì„œ ìƒˆë¡œìš´ featureë¥¼ ë§Œë“¤ê³  ì ìš© í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹¬ì„ ìˆ˜ ìˆëŠ” EDAì˜€ë‹¤. 

ë˜í•œ EDAë¥¼ í•˜ë©´ì„œ ì •ë§ dataì•ˆì—ì„œ ì–´ë–¤ ì¼ì´ ì¼ì–´ë‚˜ê³  ì–´ë–¤ ìƒí™©ì´ì—ˆëŠ”ì§€ì— ëŒ€í•´ ìƒìƒí•  ìˆ˜ ìˆë‹¤ë©´

dataì— ëŒ€í•œ ì´í•´ë„ê°€ ë†’ì•„ ì§ˆ ê²ƒì´ë‹¤
```

- ê° ë°ì´í„°ë“¤ì˜ ë¶„í¬, í‰ê·  , Min, Max ,Std ê°’ë“¤ ì‹œê°í™”
- ì›” ë‹¨ìœ„ íŒë§¤ëŸ‰
- ì›” ë‹¨ìœ„ Total 300 ì´ìƒ ë¹„ìœ¨
- Descriptionì— ëŒ€í•œ ì´í•´
    1. Post,Bank Charges,Test,Adjust,M,Crukë“± product_idì™€ descriptionì— ì˜ë¬¸ ëª¨ë¥¼ ë‹¨ì–´ë“¤ì´ ìˆìŒ 
    2. TestëŠ” ì„ì‹œë¡œ Testí•´ë³¸ ê²°ê³¼ ì¦‰, root ì•„ì´ë””ë¡œ ì„ì˜ë¡œ Testìƒí’ˆì„ ë§Œë“ ê²ƒìœ¼ë¡œ ì¶”ì • 
    PostëŠ” íƒë°°ë¥¼ ë³´ë‚¸ ê²ƒìœ¼ë¡œ ì¶”ì •
    Bank_charges í•­ìƒ ìŒìˆ˜ ê°’ìœ¼ë¡œ í‘œê¸°ë˜ëŠ” ê±¸ë¡œ ë³´ì•„ ì„¸ê¸ˆ ì§€ë¶ˆë¡œ ì¶”ì •
    Crukâ†’ ìì„  ë‹¨ì²´ì—  ê¸°ë¶€
    Adjustâ†’ testì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì¡°ì •
- êµ­ê°€ë³„ ë¶„í¬ë„ ì‹œê°í™”â†’ 90%ì •ë„ê°€ United Kingdom 10% ë‚˜ë¨¸ì§€ êµ­ê°€ë“¤ â†’ Totalê³¼ì˜ ì—°ê´€ì„±ì€ ì ì–´ ë³´ì¸ë‹¤
- Group_by_customer-quantityâ†’ ë§ì´ ì‚° ì‚¬ëŒì¼ìˆ˜ë¡ 300$ì´ìƒ êµ¬ë§¤ ë¶„í¬ê°€ ë†’ìŒ
ë§ì´ ì‚¬ë©´ ë‹¹ì—°íˆ êµ¬ë§¤ ê¸ˆì•¡ì´ ì»¤ì§€ë‹ˆ ë†’ì„ ìˆ˜ ë°–ì— ì—†ë‹¤ .
- Customer-order_idâ†’ order_idê°€ ê°™ë‹¤ë©´ í•œë²ˆì— ê°™ì´ êµ¬ë§¤í•œ ëª©ë¡ â†’ ë§ì´ êµ¬ë§¤í•œ ì‚¬ëŒì€ 300$ì´ìƒ êµ¬ë§¤ ë¶„í¬ê°€ ë†’ìŒ quantitiyì™€ ë¹„ìŠ·í•œ ì´ìœ 

## ğŸ’¡[Environment]

---

- Window 10
- VsCode
- GPU-p40
- Python, Notebook

## ğŸ’¡[Train & Valid Set]

---

- ê²€ì¦ ì „ëµ(Validation Test)
    1. StratifiedKFold -10Foldë¥¼ ì‚¬ìš©í•˜ì—¬ ê° í´ë“œë³„ë¡œ AUC_Scoreë¥¼ ê³„ì‚°í•˜ì—¬ 10í´ë“œì— ëŒ€í•´ì„œ ê°ê° best Auc_scoreë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤
- ì‚¬ìš©í•œ ëª¨ë¸ ì•„í‚¤í…ì³ ë° í•˜ì´í¼ íŒŒë¼ë¯¸í„°
    1. Light_gbm
        - LB_Score: 0.86005
        - Feature ê°œìˆ˜ : 55ê°œ

        ```markdown
        model_params:
        	'binary' -> ì´ì§„ë¶„ë¥˜
        	'gdbt' -> boosting type
        	'auc' -> í‰ê°€ ì§€í‘œ
        	'feature_fraction'=0.8 -> í”¼ì³ ìƒ˜í”Œë§ ë¹„ìœ¨
        	'bagging_fraction'=0.8 -> ë°ì´í„° ìƒ˜í”Œë§ ë¹„ìœ¨
        	'n_estimators'=10000 -> bagging freq
        	'early_stopping_rounds'=100
        	'seed'=777
        ```

        - Train: 2009-12~2011-10 ê¸°ê°„ì˜ ìœ ì € dataë¥¼ í†µí•´ í•™ìŠµ
        - Valid: 2009-12~2011-10 ê¸°ê°„ì˜ ìœ ì € dataë¥¼ í†µí•´ 2012-11ì›” label ì˜ˆì¸¡
    2. NN_Model
        - LB Score: 0.8594

        ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a55d3b98-aca2-4254-ae5c-a62014484dd5/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a55d3b98-aca2-4254-ae5c-a62014484dd5/Untitled.png)

    - 3ê³„ì¸µ layer  model
    - 3ë²ˆì˜ dropout, batchnorm ì ìš©
    - Activation funtionìœ¼ë¡œ Relu ì‚¬ìš©
    - 512, 1024 ê°œì˜ nodeë¥¼ ê°€ì§„ hidden layer ì‚¬ìš©
    - Optimizerâ†’ Adam
    - Lr=3e-4
    - Schedulerâ†’ ReduceOnplatue(patience=8, gamma=0.2)

    ### âœ”[ë„ì „í•œ ê¸°ìˆ  ë° Feature]

    ---

    ### [Skill]

    - Out_of_fold ensambleâ†’ 10ê°œì˜ í´ë“œë¥¼ í†µí•´ì„œ predictê°’ì„ êµ¬í•´ì„œ meaní•œ ê°’ì„ ì˜ˆì¸¡ê°’ìœ¼ë¡œ ì‚¬ìš© . ì¼ì¢…ì˜ Regulationê¸°ë²•
    - StratifiedKfoldâ†’ labelì˜ 0,1ì˜ ë¹„ìœ¨ì´ imbalanceí•˜ê¸°ì— ë°ì´í„°ì˜ ë¶„í¬ë¥¼ ë§ì¶°ì„œ Kfoldì‚¬ìš© â†’data imbalenceë¥¼ í•´ê²° ë° Regulationê¸°ë²•
    - NN_model & Tree_model Ensambleâ†’ íŠ¸ë¦¬ëª¨ë¸ì—ì„œ predictí•œ ê°’ê³¼ nn ëª¨ë¸ì—ì„œ prdictí•œ ê°’ì„ ì•™ìƒë¸”â†’ Regulation
    - Batchnorm,Dropout â†’ í”¼ì³ëŠ” 50ê°œ ì •ë„ì¸ë° ëª¨ë¸ì˜ nodeëŠ” 512-1024-1024ì˜ nodeë¥¼ ê°€ì§   featureì— ë¹„í•´ ëª¨ë¸ì´ ë„ˆë¬´ ë³µì¡í•¨ ì¦‰ overfittingì´ ë°œìƒí•  ê°€ëŠ¥ì„±ì´ í¬ë¯€ë¡œ, batchnormê³¼ dropoutë¥¼ ëª¨ë‘ ì‚¬ìš©í•˜ì—¬ ê·œì œë¥¼ ê°•í™”í•¨

    ### [Feature]

    1. Base Feature aggâ†’ ì„±ê³µ

    ```markdown
    ğŸ’¡ Featureë“¤ì— ëŒ€í•œ [Min, Max, Mean, Sum, Count, Std, Skew, Quantile] Agg

    1.
    -> ì£¼ì–´ì§„ Featureë“¤ì— ëŒ€í•´ì„œ numericí˜•ì´ ì•„ë‹Œ obj Typeë“¤ì— ëŒ€í•´ì„œ Label encoding í˜¹ì€
    ê²°ì¸¡ì¹˜ ê°’ì— ëŒ€í•´ì„œ SimpleInputerë¥¼ ì´ìš©í•˜ì—¬ ê²°ì¸¡ì¹˜ ê°’ë“¤ì„ medianê°’ìœ¼ë¡œ ëŒ€ì²´ í•´ì„œ Feature
    ì˜ ê°œìˆ˜ë¥¼ ëŠ˜ë ¤ ì£¼ì—ˆìŠµë‹ˆë‹¤. 
    2.
    -> ì²˜ìŒì—ëŠ” dataì— ëŒ€í•œ ì´í•´ë„ê°€ ë¶€ì¡±í•´ì„œ price, quantity, total ë“± ëª¨ë“  featureì— ëŒ€í•´ì„œ 
    aggë¥¼ í•´ì£¼ì—ˆëŠ”ë° ìƒê°í•´ë³´ë©´ price*quantitiy=total ì¸ë° êµ³ì´ priceì™€ quantityì™€ totalì´ 
     ì¤‘ë³µë˜ëŠ” ë¶€ë¶„ë“¤ì— ëŒ€í•´ì„œëŠ” feature ë¥¼ ì¶”ê°€ í•´ì¤„ í•„ìš”ê°€ ì—†ì—ˆë‹¤. 
    3.
    -> LB ì ìˆ˜ í¬ê²Œ ìƒìŠ¹ í•˜ì§€ë§Œ ëª¨ë“  í”¼ì³ì— aggë¥¼ ì‚¬ìš©í–ˆê¸°ì— ìƒê´€ê´€ê³„ì— ëŒ€í•œ ì´í•´ê°€ ë¶€ì¡±í–ˆê³ 
    ì–´ë–¤ featureê°€ ì¤‘ìš”í•˜ê³  ì•ˆì¤‘ìš”í•œì§€ì— ëŒ€í•œ ì´í•´ê°€ ë¶€ì¡±í–ˆë‹¤.

    [ë°°ìš´ì ]
    âœ” í•­ìƒ featureë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ aggë¥¼ í•  ë•Œ ë…¼ë¦¬ì ìœ¼ë¡œ ì ‘ê·¼í•˜ê³  dataë¶„ì„ì„ í†µí•´ ë‚©ë“¤ í• ë§Œí•œ 
    ê·¼ê±°ë¥¼ ê°€ì§€ê³  ì‹œë„í•´ ë³¼ê²ƒ . ë§ˆêµ¬ì¡ì´ì‹ featureì¶”ê°€ì™€ aggëŠ” ì˜¤íˆë ¤ ë” ë‚˜ì€ ëª¨ë¸ì„ ë§Œë“œëŠ”ë°ì— 
    ìˆì–´ì„œ ë…ì´ ë  ìˆ˜ ìˆë‹¤. 
    ```

    2. ì‹œê°„ Feature ì¶”ê°€ â†’ ì‹¤íŒ¨ LB_score í•˜ë½

    ```markdown
    ğŸ’¡ Customer_id ë³„ë¡œ ì–´ëŠ ì‹œê°„ëŒ€ì— ìƒ€ëŠ”ì§€ -> ì£¼ë¡œ ì•„ì¹¨ì— ìƒ€ëŠ”ì§€, ì ì‹¬ì— ìƒ€ëŠ”ì§€, ì €ë…ì—
    ìƒ€ëŠ”ì§€ì— ëŒ€í•´ ë‚˜ëˆ ì„œ label_encodingì„ í†µí•´ featureë¡œì¨ ì‚¬ìš©í–ˆë‹¤. 

    [ì ‘ê·¼ë²•]
    ì•„ì¹¨ì— ì‚¬ëŠ” ì‚¬ëŒì€ ì†Œë§¤ìƒì¼ ê²½ìš°ê°€ í¬ë‹¤-> ì¼ë°˜ì¸ì˜ ê²½ìš° ì•„ì¹¨-ë‚® ì‹œê°„ëŒ€ì— ì§ì¥, í•™êµ, 
    ë“± ì—…ë¬´ë¥¼ ë³´ëŠ” ì‹œê°„ì´ ë§ì„ ê²ƒì´ë¼ëŠ” ìƒê°ì—ì„œ ì ‘ê·¼í•˜ì˜€ë‹¤. ì†Œë§¤ìƒì¼ ê²½ìš°ëŠ” ì—…ë¬´ê°€ ë¬¼ê±´ì„
    ì‚¬ê³  íŒŒëŠ” ì¼ì´ë‹ˆ ì—…ë¬´ë¡œì¨ ì•„ì¹¨ì‹œê°„ëŒ€ì— ë¬¼ê±´ì„ ìƒ€ì„ ê²ƒì´ë¼ê³  ì ‘ê·¼ í•˜ì˜€ë‹¤.
    ì¦‰ -> ì†Œë§¤ìƒë“¤ì€ ì¼ë°˜ì¸ë“¤ ë³´ë‹¤ ë¬¼ê±´ì„ ë‹¤ëŸ‰ êµ¬ì…í•˜ë‹ˆ , ë” ë†’ì€ í™•ë¥ ë¡œ 300ë‹¬ëŸ¬ë¥¼ ì‚´ ê²ƒì´ë‹¤

    [ì‹¤íŒ¨ì›ì¸ ë¶„ì„]
    ì´ë¯¸ featureë¡œì„œ ì‚¬ìš©í•˜ëŠ” quantityì— êµ¬ë§¤ ê°œìˆ˜ê°€ ìˆë‹¤. ì¦‰ quantityë¥¼ í†µí•´ì„œë„ 
    ê·¸ ì‚¬ëŒì´ ì†Œë§¤ìƒì¸ì§€ ì¼ë°˜ì¸ì¸ì§€ êµ¬ë¶„ ê°€ëŠ¥ í• ê²ƒì´ë¼ê³  ì¶”ë¡ í•˜ì˜€ê³  quantityì˜ íŠ¹ì„±ì´ 
    ì•„ë¬´ë˜ë„ ì‹œê°„ìœ¼ë¡œ ë‚˜ëˆˆ ê²ƒë³´ë‹¤ ë” ì •í™•í•˜ê²Œ êµ¬ë¶„ì´ ê°€ëŠ¥í•´ì„œ ì˜¤íˆë ¤ ì ìˆ˜ê°€ í•˜ë½í–ˆë‹¤ê³  
    ìƒê°í•œë‹¤. 
    ```

    3. ê¸°ê°„ ë³„ Total 300 ì´ìƒ ë¹„ìœ¨ Feature ì¶”ê°€â†’ ì„±ê³µ

    ```markdown
    ğŸ’¡ ê¸°ê°„ë³„ë¡œ ë‚˜ëˆ„ì–´ì„œ customerì˜ 300ë‹¬ëŸ¬ ì´ìƒì˜ ë¹„ìœ¨ì„  feature ë¡œ ì‚¬ìš©í•˜ì˜€ë‹¤.

    [ì ‘ê·¼ë²•]
    1. predictëŠ” 300ë‹¬ëŸ¬ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê·¸ ì´ìƒì´ëƒ ì´í•˜ë¥¼ predictí•˜ëŠ” ë¬¸ì œì¸ë° 300ë‹¬ëŸ¬ì™€ 
    ê´€ë ¨ëœ featureê°€ total í•˜ë‚˜ë°–ì— ì—†ìŒ -> 300ë‹¬ëŸ¬ì— ê´€í•œfeatureê°€ ë„ˆë¬´ ì ë‹¤ê³  ìƒê° 

    2. ìµœê·¼ 3, 6, 12,20 ê°œì›”ì— ëŒ€í•´ì„œ 300ë‹¬ëŸ¬ë¥¼ ë„˜ëŠ” totalê°’ì˜ ë¹„ìœ¨ì„ êµ¬í•˜ì—¬ featureë¡œì¨ 
    ì¶”ê°€í•´ ì£¼ì—ˆë‹¤ . 

    ì™œ ê¸°ê°„ì„ ë‚˜ëˆ´ëŠ”ê°€? ë¬¼ê±´ì„ ì–´ë–¤ ì‚¬ì´íŠ¸ì—ì„œ ì‚¬ëŠ”ë° ìˆì–´ì„œ ìµœê·¼ êµ¬ë§¤ì¼ ì¦‰ ìµœê·¼ì— ì–¸ì œ ìƒ€ëŠ”
    ê°€ëŠ” êµ‰ì¥íˆ ì¤‘ìš”í•œ íŠ¹ì§•ì´ë¼ê³  ìƒê°í–ˆê¸° ë•Œë¬¸ì´ë‹¤. ì¦‰ 1ë…„ì „ì— 10ë²ˆ êµ¬ë§¤í•œ ê²ƒê³¼ ìµœê·¼ 3ê°œì›”ê°„
    10ë²ˆ êµ¬ë§¤í•œ ê³ ê°ì´ ìˆë‹¤ë©´ ë‹¹ì—°íˆ ìµœê·¼ 3ê°œì›” 10ë²ˆ êµ¬ë§¤í•œ ê³ ê°ì´ ë‹¤ìŒë‹¬ì— êµ¬ë§¤í•  í™•ë¥ ì´ ë†’ë‹¤ëŠ”
    ìƒê°ìœ¼ë¡œ ì ‘ê·¼í•˜ì˜€ë‹¤. 
    í•˜ì§€ë§Œ ìµœê·¼ 300ê°œì›”ì˜ ê¸°ë¡ë§Œ ë³¸ë‹¤ë©´ 0ì˜ ë¹„ìœ¨ì´ ë„ˆë¬´ ë†’ë‹¤ ì¦‰ ëª¨ë¸ì´ 0ìœ¼ë¡œ overfitting
    ë  ê²ƒì„ ìƒê°í•˜ì—¬ ê·¸ 6,12,20 ê°œì›”ì„ ë¶„ì„í•œ featureë“¤ì„ ì¶”ê°€ í•˜ì˜€ë‹¤. í•˜ì§€ë§Œ ì •í™•í•œ ê²€ì¦ì„
    í•˜ì§€ ëª»í•œ íƒ“ì— ì–´ëŠ ì‹œì ì´ ê°€ì¥ ì¤‘ìš”í•œ featureì´ ì–´ë–¤ ê²ƒì´ ì¢‹ì§€ ëª»í•œ featureì˜€ëŠ”ì§€ì— 
    ëŒ€í•œ í™•ì‹ ì„ ì–»ì§€ëŠ” ëª»í•˜ì˜€ë‹¤. 

    [ì•„ì‰¬ìš´ì ]
    ì¢‹ì€ ì ‘ê·¼ ë°©ë²•ì´ì—ˆë‹¤ê³  ìƒê°í•˜ê³  ìƒê°ëŒ€ë¡œ LB_scoreì˜ í–¥ìƒë„ ìˆì—ˆë‹¤. í•˜ì§€ë§Œ, valid_setì˜
    ì‹ ë¹™ì„±ì´ ë–¨ì–´ì§€ëŠ” íƒ“ì— ê²€ì¦ì„ ì™„ë²½í•˜ê²Œ í•˜ì§€ ëª»í•˜ê³  ì˜¤ì§ LB scoreë¡œë§Œ ì§ì‘ í•  ìˆ˜ ìˆì—ˆë‹¤.
    ```

    4. ì›” product_id*quantity ë¹„ìœ¨ Feature ì¶”ê°€ â†’ ì‹¤íŒ¨

    ```markdown
    ğŸ’¡ ì›”ë³„ë¡œ product_id*quantity/ì „ì²´ product_id*quantity ì˜ ë¹„ìœ¨ì„ feature ì‚¬ìš©

    [ì ‘ê·¼ë²•]
    ìƒí’ˆë³„ë¡œ ê³„ì ˆì— ë”°ë¼ ì˜íŒ”ë¦¬ëŠ” ìƒí’ˆê³¼ íŒ”ë¦¬ì§€ ì•ŠëŠ” ìƒí’ˆë“¤ì´ ìˆë‹¤ëŠ” ê²ƒì„ EDAë¥¼ í†µí•´ 
    ë¶„ì„í•˜ì˜€ë‹¤. ì¦‰, ì—¬ë¦„ ì œí’ˆì„ ë§ì´ ì‚¬ëŠ” ê³ ê°ì€ ê²¨ìš¸ ìƒí’ˆì„ ì‚¬ì§€ ì•Šì„ ê²ƒì´ë‹¤. ê²¨ìš¸ ì œí’ˆì„ 
    ì‚¬ëŠ” ê³ ê°ì€ ì—¬ë¦„ ì œí’ˆì„ ì‚¬ì§€ ì•Šì„ ê²ƒì´ë‹¤ ë¼ëŠ” ìƒê°ì—ì„œ ì ‘ê·¼ í•˜ì˜€ë‹¤.

    [ì‹¤íŒ¨ì›ì¸]
    Dataë¥¼ ë¶„ì„í•´ë³¸ ê²°ê³¼ í™•ì‹¤íˆ ì†Œë¹„ì ë³„ë¡œ ì—¬ë¦„/ê²¨ìš¸ì— ëŒ€í•œ ìƒí’ˆ ì„ í˜¸ë„ê°€ ìˆê¸´ í•˜ì˜€ë‹¤.
    í•˜ì§€ë§Œ ìƒí’ˆ ì„ í˜¸ë„ì™€ 300ë‹¬ëŸ¬ì˜ ì—°ê´€ì„±ì´ í¬ì§€ ì•Šì•˜ë˜ ê²ƒìœ¼ë¡œ ìƒê°ëœë‹¤. 
    ```

    5. PCA ê¸°ë²•ìœ¼ë¡œ  feature ì¶”ê°€â†’ ì‹¤íŒ¨ 

    ```markdown
    ğŸ’¡ì‚¬ìš©í•˜ê³  ìˆë˜ featureë“¤ì„ PCAê¸°ë²•í•˜ì—¬ ìƒˆë¡œìš´ 10ê°œì˜ PCA featureë¥¼ ì¶”ê°€ 

    [ì ‘ê·¼ë²• ]
    ì‚¬ìš©í•˜ê³  ìˆë˜ featureê°€ 30~40ê°œ ì •ë„ì˜€ëŠ”ë°  ì´ featureë“¤ì˜ ê´€ê³„ë¥¼ ìƒˆë¡œìš´ 10ì°¨ì›ìœ¼ë¡œ 
    ì¤„ì—¬ì„œ 10ê°œì˜ featureë¡œ ìƒˆë¡œ ìƒì„±í•œë‹¤ë©´ ì–´ë–¤ ì‹œë„ˆì§€ íš¨ê³¼ë¥¼ ë‚´ì§€ ì•Šì„ê¹Œ ë¼ëŠ” ìƒê°ìœ¼ë¡œ ì ‘ê·¼

    [ì‹¤íŒ¨ ì›ì¸]
    ì‚¬ìš©í•˜ê³  ìˆë˜ featureë“¤ì´ ëª¨ë‘ ê²€ì¦ëœ featureì´ ì•„ë‹ˆì—ˆë‹¤. ì¦‰ featureë“¤ê°„ì˜ ìƒê´€ê´€ê³„ ë°
    ì •í™•í•œ íŠ¹ì§•ë“¤ì„ ì´í•´í•˜ì§€ ëª»í•œ ìƒíƒœì—ì„œ PCAë¥¼ í†µí•´ ìƒˆë¡œìš´ featureë¥¼ ì¶”ê°€í•œë“¤ ê·¸ feature
    ë“¤ì´ ì–´ë– í•œ ì—°ê´€ì„±ì´ë‚˜ ìƒˆë¡œìš´ íŠ¹ì§•ì„ ë§Œë“¤ì—ˆë‹¤ê³  ìƒê°í•˜ê¸° ì–´ë µë‹¤.. 

    [ë°°ìš´ì ]
    ìì‹ ì´ ì‚¬ìš©í•˜ëŠ” featureì˜ íŠ¹ì§•ì„ ëª…í™•íˆ ì´í•´í•´ì•¼ PCAê¸°ë²•ìœ¼ë¡œ featureë“¤ê°„ì˜ ìƒˆë¡œìš´
    íŠ¹ì§•ì„ ë½‘ì•„ ë‚¼ ìˆ˜ ìˆë‹¤ê³  ìƒê°í•œë‹¤. ì¦‰ ë§‰ì—°í•˜ê²Œ ì—¬ëŸ¬ skillë“¤ì„ ì‚¬ìš©í•œë‹¤ê³  ë‚´ featureì—
    ë§ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ëŠ” ê²ƒ
    ```

    6. ìµœê·¼/ë§ˆì§€ë§‰ êµ¬ë§¤ì¼ feature ì¶”ê°€ â†’ ì„±ê³µ 

    ```markdown
    ğŸ’¡Recent_buyë¼ëŠ” Featureë¥¼ ì¶”ê°€ -> ê³ ê°ì´ ê°€ì¥ ìµœê·¼ì— ì–¸ì œ êµ¬ë§¤í–ˆëƒ í˜¹ì€ ê°€ì¥ ë§ˆì§€ë§‰ 
    êµ¬ë§¤ì¼ ì–¸ì œì¸ê°€ë¥¼ featureë¡œì¨ ì¶”ê°€ í–ˆìŒ

    [ì ‘ê·¼ë²•]
    ì˜ˆì¸¡í•´ì•¼ í•˜ëŠ” ì›”ê³¼ ìµœê·¼ êµ¬ë§¤ì¼ì´ ê°€ê¹ë‹¤ë©´ ë˜ ë‹¤ì‹œ ì‚´í™•ë¥ ì´ ë†’ë‹¤ëŠ” ì•„ì´ë””ì–´ì—ì„œ ì°©ì•ˆ 
    ì¦‰ í•œë‹¬ì „ì— ë¬¼í’ˆì„ ì‚° ê³ ê°ì´ 1ë…„ì „ì— ë¬¼í’ˆì„ ì‚° ê³ ê°ë³´ë‹¤ ë‹¤ìŒë‹¬ì— êµ¬ë§¤í•  í™•ë¥ ì´ ë†’ë‹¤ê³ 
    ìƒê°í•˜ì˜€ë‹¤ .
    [ì„±ê³µì´ìœ ]
    ìƒê°í•œëŒ€ë¡œ ìµœê·¼ì— ì‚° ê³ ê°ì¼ìˆ˜ë¡ ë‹¤ìŒë‹¬ì—ë„ ì‚´ í™•ë¥ ì´ ë†’ë‹¤ëŠ” ê²°ê³¼ë¥¼ ì–»ì—ˆê³  , scoreì—ë„
    ìƒìŠ¹ì´ ìˆì—ˆë‹¤.
    ```

## ğŸ˜¢[ì•„ì‰¬ìš´ì ]

---

1. Train dataì˜ ë¶€ì¡± : 

 í•™ìŠµ ë°ì´í„°ëŠ” 2ë…„ì´ ì•ˆë˜ëŠ” ê¸°ê°„ì´ì—ˆê³  ëª¨ë“  dataë¥¼ ì‚¬ìš©í•˜ì—¬ 11ì›” í•˜ë‚˜ ë§Œì„ ì˜ˆì¸¡í•˜ëŠ” trainê³¼ì •ì„ ê±°ì³ì„œ ê²€ì¦ì„ í•˜ì˜€ìŒ.
 í•˜ì§€ë§Œ ê´€ì ì„ ì¡°ê¸ˆ ë°”ê¿”ì„œ trainì„  9,10,11ì›”ì— ëŒ€í•´ train ì‹œì¼°ë‹¤ë©´ train_dataë¥¼ ë” ëŠ˜ë¦¬ë©´ì„œ ì¢€ ë” ë†’ì€ scoreë¥¼ ë°›ì„ ìˆ˜ ìˆì§€ ì•Šì•˜ì„ê¹Œ ë¼ëŠ” ìƒê°ì„ í–ˆê³ , ì‹¤ì œë¡œë„ ìƒìœ„ê¶Œ ìœ ì €ë“¤ì´ train_setì„ ëŠ˜ë ¤ì„œ í•™ìŠµì„ ì‹œì¼°ë‹¤ê³  í•œë‹¤.
`ìƒê°í•œ ê²ƒì€ ì–´ë µë”ë¼ë„ ì‹¤ì²œí•´ë³¼ê²ƒ!`

2. ì‹œê°í™” êµ¬í˜„ì˜ ë¶€ì¡± : 

ì‚¬ëŒì´ ë§ì€ ìˆ˜ì˜ dataë¥¼ ë³´ê³  ì§ê´€ì ìœ¼ë¡œ ì–´ë–¤ ë¶„í¬ë¥¼ ê°–ê³  ì–´ë–¤ íŠ¹ì„±ì„ ê°–ëŠ”ì§€ ë¶„ì„í•˜ê¸°ëŠ” ì–´ë µë‹¤.
 ê·¸ë˜ì„œ dataë¥¼ ì‹œê° í™” í•˜ì—¬ ë¶„ì„í•˜ë©´ ì¢€ ë” ì§ê´€ì ìœ¼ë¡œ ë¶„ì„í•  ìˆ˜ ìˆê³  ìì‹ ì˜ ê°€ì„¤ì— ëŒ€í•œ ì‹ ë¢°ì„±ì„ ì–»ì„ ìˆ˜ ìˆë‹¤.  í•˜ì§€ë§Œ ì‹œê°í™”ë¥¼ ë§ì´ ì—°ìŠµí•´ ë³´ì§€ ì•Šì•˜ë˜ íƒ“ì— dataë¥¼ ì‹œê°í™”í•˜ëŠ”ë° ì–´ë ¤ì›€ì„ ë§ì´ ê²ªì—ˆê³  , ë‚´ ê°€ì„¤ì„ ì‹œê°í™”í•˜ì—¬ ê²€ì¦í•˜ì§€ ëª»í•œ ê²½ìš°ê°€ ì¢…ì¢… ìˆì—ˆë‹¤.
`ì‹œê°í™”ëŠ” êµ¬í˜„ì—°ìŠµì„ ê³„ì†í•´ë³¼ ê²ƒ!`

3. Tree_Modelì— ëŒ€í•œ ì´í•´ë„ ë¶€ì¡±:

Tree_modelì„ ì´ë²ˆ ê²½í—˜ì„ í†µí•´ì„œ ì²˜ìŒ ì ‘í•´ë´¤ëŠ”ë°, bagging,boostingë“± ë‹¤ì–‘í•œ ë°©ë²•ê³¼ entropy, Gini , info_gainë“± ë‹¤ì–‘í•œ ë°©ë²•ì„ í†µí•´ì„œ nodeë“¤ì„ ìƒì„±í•´ ë‚¸ë‹¤ëŠ” ê²ƒì„ ë°°ìš¸ ìˆ˜ ìˆì—ˆê³ , deep learning modelì•„ë‹Œ ë¶„ë¥˜ê¸°ì˜ ì—­í• ì„ í•˜ëŠ” ë§Œí¼
ìˆ˜í•™ì  ê³„ì‚°ì„ ìš”êµ¬í•˜ëŠ” ë‚´ìš©ë“¤ì´ ë§ì•˜ë‹¤. ì•„ì§ ëª¨ë¸ì— ëŒ€í•œ ì´í•´ê°€ ë¶€ì¡±í•˜ë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹¬ì•˜ê³ , ëª¨ë¸ì˜ ì´í•´ê°€ ë–¨ì–´ì§€ë‹ˆ model_tuningì„ ì œëŒ€ë¡œ í•  ìˆ˜ ì—†ì—ˆê³  sotaì˜ ì„±ëŠ¥ì„ ì´ëŒì–´ë‚´ì§€ ëª»í–ˆë‹¤ê³  ìƒê°í•œë‹¤. 
`íŠ¸ë¦¬ëª¨ë¸ì— ëŒ€í•œ ì´í•´ë„ ë†’ì´ê¸°`

4. DataFrame ì¡°ì‘ ë¯¸ìˆ™:

Pandasì˜ DataFrame ì„ ì´ìš©í•˜ì—¬ csvíŒŒì¼ì„ ë‹¤ë£¨ê±°ë‚˜ ê¸°ë³¸ì ì¸ functionë“¤ë§Œ ì£¼ë¡œ ì‚¬ìš©í–ˆì—ˆë‹¤. ì´ë²ˆ ê²½ìš°ì²˜ëŸ¼ featureë“¤ì„ ìƒˆë¡œ ë§Œë“¤ê³  í•´ë³¸ ê²½í—˜ì´ ì—†ì—ˆë˜ íƒ“ì´ë‹¤. columnsë“¤ì´ ê³„ì¸µ êµ¬ì¡°ë¥¼ ì´ë£° ìˆ˜ ìˆê³  ì´ê²ƒì— ëŒ€í•´ ì ‘ê·¼í•˜ëŠ” ë°©ë²• ë˜í•œ ì¡´ì¬í–ˆì—ˆê³   groupby,concat,mergeë“± sqlì—ì„œ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” functionë“¤ì´ DataFrameì—ë„ ëª¨ë‘ êµ¬í˜„ë˜ì–´ ìˆìŒì„ ì•Œì•—ë‹¤. DataFrameì€ Hashêµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— iloc, locì„ í†µí•´ì„œ ëª¨ë“  ì¸ë±ìŠ¤ì— ëŒ€í•œ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ê³  O(1)ì˜ ì‹œê°„ë³µì¡ë„ë¡œ columnì´ë‚˜ Rowë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ”ë° , ì¡°ì‘ì´ ë¯¸ìˆ™í•˜ì—¬ for loopë¥¼ ëŒë©´ì„œ í•˜ë‚˜í•˜ë‚˜ ë¹„êµí•´ê°€ë©´ì„œ ì¸ë±ìŠ¤ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë“± ì‹œê°„ë³µì¡ë„ ì¸¡ë©´ì—ì„œ ë„ˆë¬´ ë¹„íš¨ìœ¨ì ì¸ codeë“¤ì´ ë§ì•˜ë‹¤. ì¢€ ë” ëŠ¥ìˆ™í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì—°ìŠµì´ í•„ìš”í•˜ë‹¤.

## ğŸ‘[ë§ˆë¬´ë¦¬]

---

Tabular Dataë¥¼ ì´ìš©í•œ Competitionì„ í†µí•´ì„œ ë¶€ì¡±í•œ ë¶€ë¶„ê³¼ ë‚˜ì˜ ê°•ì ì„ íŒŒì•…í•  ìˆ˜ ìˆëŠ” ê¸°íšŒê°€ ë˜ì—ˆìŠµë‹ˆë‹¤. ì½”ë“œ ìˆ™ë ¨ë„ì˜ ë¯¸ìˆ™, DataFrame ì¡°ì‘, ì‹œê°í™” êµ¬í˜„ ë¯¸ìˆ™, Modelì— ëŒ€í•œ ì´í•´ì˜ ì¤‘ìš”ì„±, Featureë¶„ì„ì˜ ì¤‘ìš”ì„± ë“±ì— ëŒ€í•´ì„œ ê¹¨ë‹¬ì•˜ìœ¼ë©°, dataë¥¼ í†µí•´ í•´ë‹¹ ìƒí™©ì— ëŒ€í•œ ìƒìƒì„ í•˜ê³  ìƒˆë¡œìš´ featureë¥¼ ë½‘ì•„ë‚´ê³ , validationì˜ ì¤‘ìš”ì„±ì— ëŒ€í•´ íŠ¹íˆ ì¤‘ìš”í•¨ì„ ëŠê¼‡ìŠµë‹ˆë‹¤. validationì˜ ì‹ ë¢°ì„±ì´ ì—†ë‹¤ë©´ ë‚˜ì˜ ê°€ì„¤ì„ ê²€ì¦í•  ë°©ë²•ì´ ì—†ë‹¤ëŠ” ê²ƒ. ë” ì •í™•í•œ valid setì„ êµ¬í˜„í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ì´ë²ˆ ëŒ€íšŒë¥¼ í†µí•´ ì ˆì‹¤íˆ ëŠê¼ˆìŠµë‹ˆë‹¤. 
 êµ¬í˜„ì´ ì–´ë µë‹¤ê³  í¬ê¸°í•˜ì§€ ì•Šì€ ë¶€ë¶„, ì—¬ëŸ¬ê°€ì§€ ê°€ì„¤ì„ ì„¸ìš°ê³  ë„ì „í•œ ê²ƒ. ì´ ë‘ ê°€ì§€ëŠ” ì´ë²ˆ ê²½í—˜ì„ í†µí•´ì„œ ë‚˜ì˜ ê°•ì ìœ¼ë¡œ ë‚¨ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.



 ---
 
### inference.py
```
~$ python infernence.py --model --num_features --hidden_size --batch_size --seed 
```
### args:
  - model: [light_bgm, nn_model ,type=str, default=light_bgm] 
  > select which model to use 

  - num_features: [type=int , default=55] 
  > select feature nums 

  - hidden_size: [type=int, default=1024] 
  > how many nodes to use in hidden layer 

  - batch_size:[type=int, defalut=512] 
  > select batch_size

  - seed:[type=int, default=777] 
  > seed num for reproduction 

--- 

### utils.py 
  - seed_everything
  > set seed for reproduction

  - print_score
  > matric for evaluating score 
  - make_product_month
  > make obj-> numeric tpye of product_id with group_by month
  - make_month_over_train_300
  > feature extraction by bins of 3,6,9,20 month with groupby [customer_id ,year_month] ratio of over 300$
  - make_month_over_test_300
  > same with above but using year_month 2011-11
  - make_time_corr_train
  > feature extraction by bins of order_data 

  - make-time _corr_train
  > same with above
---
### features.py 

- generate_label
```
return label
```
> making labels by 2011-11 
- make_feature 
```
return x_tr, x_te
```
> transform obj-> numeric tpye and fill None values with Median values 
- feature_engineering1
```
return : x_tr, x_te, all_train_data['label'],features
```
> adding features and agg function for features 



